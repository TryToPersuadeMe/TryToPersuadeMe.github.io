const header={button:"header__burgerMenu",navigation:"navigation",screen:"wrapper",logo:"header__logo",language:"language"},handleClick=document.querySelector("."+header.button),nav=document.querySelector("."+header.navigation),body=document.getElementsByTagName("body")[0],screen=document.querySelector("."+header.screen),logo=document.querySelector("."+header.logo),language=document.querySelector("."+header.language),chooseLanguage=document.querySelectorAll("."+header.language);handleClick.addEventListener("click",(function(){this.classList.toggle(header.button+"_active"),nav.classList.toggle(header.navigation+"_active"),screen.classList.toggle("shadow"),body.classList.toggle("block"),handleClick.classList.contains(header.button+"_active")?(logo.style.opacity=0,language.style.opacity=0):(logo.style.opacity=1,language.style.opacity=1)})),window.addEventListener("click",(function(){event.target==nav&&nav.classList.contains(header.navigation+"_active")&&event.target!=handleClick&&(body.classList.remove("block"),handleClick.classList.remove(header.button+"_active"),nav.classList.remove(header.navigation+"_active"),screen.classList.remove("shadow"),logo.style.opacity=1,language.style.opacity=1)}));const menuLink=document.querySelector(".navigation__links_service"),subMenu=document.querySelector(".subMenu");menuLink.addEventListener("mouseenter",(function(){let e=event.currentTarget.nextElementSibling;e.classList.add("subMenu_active"),e.style.maxHeight=10*e.scrollHeight+"px"})),subMenu.addEventListener("mouseleave",(function(){subMenu.classList.remove("subMenu_active"),subMenu.style.maxHeight=subMenu.style.maxHeight=0})),screen.addEventListener("click",(function(){event.target!=subMenu&&(subMenu.style.maxHeight=subMenu.style.maxHeight=0,subMenu.classList.remove("subMenu_active"))})),language.addEventListener("click",(function(){this.querySelector("."+header.language+"__wrapper").classList.toggle(header.language+"_open")}));for(const e of document.querySelectorAll("."+header.language+"__item"))e.addEventListener("click",(function(){this.classList.contains("."+header.language+"__item_selected")||(this.parentNode.querySelector("."+header.language+"__item."+header.language+"__item_selected").classList.remove("."+header.language+"__item_selected"),this.classList.add(header.language+"__item_selected"),this.closest("."+header.language+"__wrapper").querySelector("."+header.language+"__choosen").innerHTML=this.innerHTML)}));window.addEventListener("click",(function(e){const t=document.querySelector("."+header.language+"__wrapper");t.contains(e.target)||t.classList.remove(header.language+"_open")}));const totalInput=document.getElementById("totalQuantity");let totalSumPerTick,tickCoef=1e6,pricePerStep=100,discount=!0;window.addEventListener("DOMContentLoaded",()=>{new rSlider({element:"#sliderRange",tick:1,totalSum:"#totalSum"}),new FormCount({form:".applicationForm",buttons:"input"})});class rSlider{constructor(e){this.el=document.querySelector(e.element),this.totalSum=document.querySelector(e.totalSum),this.min=+this.el.min||0,this.max=+this.el.max||100,this.step=+this.el.step||1,this.tick=e.tick||this.step,this.addTicks(),this.dataRange=document.createElement("div"),this.dataRange.className="data-range",this.el.parentElement.appendChild(this.dataRange,this.el),totalSumPerTick=this.step*pricePerStep,this.updatePos(),this.el.addEventListener("input",()=>{this.updatePos(),this.totalSum.innerText=totalSumPerTick+" рублей"}),this.totalSum.innerText=totalSumPerTick+" рублей"}addTicks(){let e=document.createElement("div");e.className="range",this.el.parentElement.insertBefore(e,this.el),e.appendChild(this.el);let t=document.createElement("div");t.className="range-ticks",e.appendChild(t);for(let e=this.min;e<=this.max;e+=this.tick){let e=document.createElement("span");e.className="range-tick",t.appendChild(e);let a=document.createElement("span");a.className="range-tick-text",e.appendChild(a)}}getRangePercent(){let e=this.el.max,t=this.el.min;return(this.el.value-t)/(e-t)}updatePos(){let e=this.getRangePercent(),t=100*e,a=3*e;this.dataRange.style.left=`calc(${t}% - ${a}em)`,totalInput.value=this.el.value*tickCoef,totalSumPerTick=this.el.value*pricePerStep,totalInput.value=totalInput.value.replace(/(\d)(?=(\d\d\d)+([^\d]|$))/g,"$1 ")}}class FormCount{constructor(e){this.buttons=document.querySelectorAll(e.buttons),this.form=document.querySelector(e.form),this.handleEvent()}handleEvent(){for(let e=0;e<this.buttons.length;e++)this.buttons[e].hasAttribute("value")||"radio"!=this.buttons[e].type||this.buttons[e].setAttribute("value","+0"),this.buttons[e].addEventListener("input",()=>{totalSum.value=Number(totalSum.innerText.match(/[0-9/.]+/g));let e=document.querySelectorAll(":checked"),t=[0],a=[0];e.forEach(e=>{e.value.includes("+")||e.value.includes("+0")?a.push(Number(e.value.replace(/\+/,""))):e.value.includes("*")&&t.push(Number(e.value.replace(/\*/,"")))});let n=a.reduce((e,t)=>e+t),l=t.reduce((e,t)=>e+t);this.discount(discount),0==l&&(l=1e-12),totalSum.value=totalSumPerTick+totalSumPerTick*l+n-this.discountSum,totalSum.innerText=Math.floor(totalSum.value)+" рублей"})}discount(e){if(e){let e=totalInput.value.replace(/\s+/g,"");this.discountSum=e>1e7?totalSum.value/100*15:e>4e7?totalSum.value/100*20:0}else this.discountSum=0}}const form=document.getElementById("silverFarmForm"),name=document.getElementById("name"),inputs=form.getElementsByTagName("input"),radioSets=document.querySelectorAll(".applicationForm__radioFieldSet");radioSets.forEach(e=>e.getElementsByTagName("input")[0].checked=!0),form.addEventListener("submit",(function(){let e={price:totalSum.innerText,matches:totalQuantity.value,name:name.value,email:email.value,contacts:contacts.value};for(let t=0;t<inputs.length;t++)"radio"==inputs[t].type&&1==inputs[t].checked&&(key=inputs[t].getAttribute("name"),value=inputs[t].nextElementSibling.innerText,e[key]=value);console.log(e),event.preventDefault();const t=JSON.stringify(e),a=new XMLHttpRequest;a.open("POST","../php/index.php"),a.setRequestHeader("Content-Type","application/json"),a.send(t),console.log(t)}));