const rules={length:0,email:/^\w{1,}@\S{1,}\.\w/i,rusWordsAndSpaces:/[А-ЯЁ ]/i,phone:/\+\d\s\(...\)\s\d{3}\-\d{2}\-\d{2}/},messages={empty:`Поле не может содержать менеее ${rules.length} символов`,rusWordsAndSpaces:"Алиас не может содержать русские буквы и пробелы",email:"Некорректно введён Email",phone:"Телефон должен быть в формате +7 (ХХХ) ХХХ-ХХ-ХХ"},classes={fieldWrapper:"form__fieldWrapper",label:"form__label",input:"form__input",message:"form__errorMessage-js"};let inputsValidate=document.querySelectorAll("."+classes.input+"[data-validate]");inputsValidate=Array.from(inputsValidate);for(const e of inputsValidate)e.addEventListener("input",(function(){validate.call(this)})),e.addEventListener("blur",(function(){validate.call(this)})),e.addEventListener("focus",(function(){validate.call(this)}));function validate(){let e=this.closest("."+classes.fieldWrapper),s=this.previousElementSibling,t=e.lastElementChild;e.lastElementChild.classList.contains(classes.message)||(t=document.createElement("p"),e.appendChild(t),t.classList.add(classes.message));const a=a=>{e.classList.remove(classes.fieldWrapper+"_valid"),s.classList.remove(classes.label+"_valid"),e.classList.add(classes.fieldWrapper+"_invalid"),s.classList.add(classes.label+"_invalid"),t.classList.add(classes.message,classes.message+"_active"),t.innerHTML=a,this.classList.add(classes.input+"_active")};let l=this.value,i=this.dataset.validate.split(",");for(let r=0;r<i.length;r++)switch(i[r]){case"email":!rules.email.test(l)&&a(messages.email);break;case"rusWordsAndSpaces":rules.rusWordsAndSpaces.test(l)&&a(messages.rusWordsAndSpaces);break;case"phone":!rules.phone.test(l)&&a(messages.phone);break;case"length":l.length>rules.length?(e.classList.remove(classes.fieldWrapper+"_invalid"),t.classList.remove(classes.message+"_active"),e.classList.add(classes.fieldWrapper+"_valid"),s.classList.add(classes.label+"_valid")):a(messages.empty)}e.firstElementChild.classList.contains(classes.label)||console.log("Label have to be before input!!!")}let allInputsArray=document.querySelectorAll("."+classes.input);allInputsArray=Array.from(allInputsArray).map(e=>e.getAttribute("id"));const form=document.querySelector(".form"),alertBanner=document.querySelector(".alert");document.addEventListener("DOMContentLoaded",()=>{for(let e of allInputsArray){let s=document.getElementById(e);s.value=localStorage.getItem(e),form.setAttribute("data-status",localStorage.getItem("formStatus")),function(e,s){s.addEventListener("input",(function(){localStorage.setItem(e,s.value),form.setAttribute("data-status","changed"),localStorage.setItem("formStatus",form.dataset.status),console.log(localStorage)}))}(e,s)}if(localStorage.length>1)for(let e=0;e<inputsValidate.length;e++)validate.call(inputsValidate[e])});let submitState=form.dataset.status;const slideToggle=(e,s)=>{e.style.maxHeight=s?0:e.scrollHeight+"px"};"submited"===submitState?(slideToggle(alertBanner,!0),console.log("Asd")):slideToggle(alertBanner,!1),form.addEventListener("submit",(function(e){invalidInputsWrapper=document.querySelectorAll("."+classes.fieldWrapper+"_invalid"),invalidInputsWrapper.length?e.preventDefault():(form.setAttribute("data-status","submited"),slideToggle(alertBanner,!0))}));