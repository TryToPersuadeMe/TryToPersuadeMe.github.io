const rules={length:0,email:/^\w{1,}@\S{1,}\.\w/i,rusWordsAndSpaces:/[А-ЯЁ ]/i,phone:/\+\d\s\(...\)\s\d{3}\-\d{2}\-\d{2}/},messages={empty:`Поле не может содержать менеее ${rules.length} символов`,rusWordsAndSpaces:"Алиас не может содержать русские буквы и пробелы",email:"Некорректно введён Email",phone:"Телефон должен быть в формате +7 (ХХХ) ХХХ-ХХ-ХХ"},classes={fieldWrapper:"form__fieldWrapper",label:"form__label",input:"form__input",message:"form__errorMessage-js"};let inputsValidate=document.querySelectorAll("."+classes.input+"[data-validate]");inputsValidate=Array.from(inputsValidate);for(const e of inputsValidate)e.addEventListener("input",(function(){validate.call(this)})),e.addEventListener("blur",(function(){validate.call(this)})),e.addEventListener("focus",(function(){validate.call(this)}));function validate(){let e=this.closest("."+classes.fieldWrapper),s=this.previousElementSibling,a=e.lastElementChild;e.lastElementChild.classList.contains(classes.message)||(a=document.createElement("p"),e.appendChild(a),a.classList.add(classes.message));const l=l=>{e.classList.remove(classes.fieldWrapper+"_valid"),s.classList.remove(classes.label+"_valid"),e.classList.add(classes.fieldWrapper+"_invalid"),s.classList.add(classes.label+"_invalid"),a.classList.add(classes.message,classes.message+"_active"),a.innerHTML=l,this.classList.add(classes.input+"_active")};let t=this.value,i=this.dataset.validate.split(",");for(let n=0;n<i.length;n++)switch(i[n]){case"email":!rules.email.test(t)&&l(messages.email);break;case"rusWordsAndSpaces":rules.rusWordsAndSpaces.test(t)&&l(messages.rusWordsAndSpaces);break;case"phone":!rules.phone.test(t)&&l(messages.phone);break;case"length":t.length>rules.length?(e.classList.remove(classes.fieldWrapper+"_invalid"),a.classList.remove(classes.message+"_active"),e.classList.add(classes.fieldWrapper+"_valid"),s.classList.add(classes.label+"_valid")):l(messages.empty)}e.firstElementChild.classList.contains(classes.label)||console.log("Label have to be before input!!!")}let allInputsArray=document.querySelectorAll("."+classes.input);allInputsArray=Array.from(allInputsArray).map(e=>e.getAttribute("id"));let invalidInputsWrapper=document.querySelectorAll("."+classes.fieldWrapper+"_invalid");const alertBanner=document.querySelector(".alert");document.addEventListener("DOMContentLoaded",()=>{for(let e of allInputsArray){let s=document.getElementById(e);s.value=localStorage.getItem(e),function(e,s){s.addEventListener("change",(function(){localStorage.setItem(e,s.value)}))}(e,s)}if(localStorage.length>0){slideToggle("alert",alertBanner,!1);for(let e=0;e<inputsValidate.length;e++)validate.call(inputsValidate[e])}});const slideToggle=(e,s,a)=>{a?(s.classList.remove(e+"_active"),s.style.maxHeight=0):(s.classList.add(e+"_active"),s.style.maxHeight=s.scrollHeight+"px")},form=document.querySelector(".form").addEventListener("submit",(function(e){0!=invalidInputsWrapper.length?e.preventDefault():slideToggle("alert",alertBanner,!0)}));